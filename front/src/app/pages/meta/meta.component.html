<h1>Metas</h1>

<!-- FormulÃ¡rio de criaÃ§Ã£o -->
<div class="nova-meta">
  <input type="text" placeholder="DescriÃ§Ã£o" [(ngModel)]="novaMeta.descricao">
  <input type="number" placeholder="Valor Atual" [(ngModel)]="novaMeta.valorAtual">
  <input type="date" placeholder="Data InÃ­cio" [(ngModel)]="novaMeta.dataInicio">
  <input type="date" placeholder="Data Fim" [(ngModel)]="novaMeta.dataFim">

  <select [(ngModel)]="novaMeta.categoria">
    <option value="" disabled selected>Selecione uma categoria</option>
    <option *ngFor="let c of categorias" [value]="c.id">{{ c.nome }}</option>
  </select>

  <button (click)="criar()">â• Criar</button>
</div>

<hr>

<h3>Lista de Metas</h3>

<table class="metas-table">
  <thead>
    <tr>
      <th>DescriÃ§Ã£o</th>
      <th>Valor Atual</th>
      <th>Data InÃ­cio</th>
      <th>Data Fim</th>
      <th>Categoria</th>
      <th>AÃ§Ãµes</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let m of metas">
      <ng-container *ngIf="editando?.id === m.id; else viewMode">
        <td><input [(ngModel)]="editando!.descricao"></td>
        <td><input type="number" [(ngModel)]="editando!.valorAtual"></td>
        <td><input type="date" [(ngModel)]="editando!.dataInicio"></td>
        <td><input type="date" [(ngModel)]="editando!.dataFim"></td>
        <td><input type="text" [value]="getCategoriaNome(editando?.categoria)" disabled></td>
        <td>
          <button (click)="salvarEdicao()">ğŸ’¾</button>
          <button (click)="cancelarEdicao()">âŒ</button>
        </td>
      </ng-container>

      <ng-template #viewMode>
        <td>{{ m.descricao }}</td>
        <td>{{ m.valorAtual }}</td>
        <td>{{ m.dataInicio | date: 'yyyy-MM-dd' }}</td>
        <td>{{ m.dataFim | date: 'yyyy-MM-dd' }}</td>
        <td>{{ getCategoriaNome(m.categoria) }}</td>
        <td>
          <button (click)="editar(m)">âœï¸</button>
          <button (click)="deletar(m.id)">âŒ</button>
        </td>
      </ng-template>
    </tr>
  </tbody>
</table>
